import './polyfills.server.mjs';
import{A as n,B as f,E as b,F as U,G as g,Ha as O,Ka as D,M as c,Na as N,O as i,P as a,Pa as T,Q as y,R as w,Ra as G,S as u,Sa as M,T as d,Ta as R,U as j,Ua as W,V as m,Va as V,W as x,Wa as I,X as F,Y as z,Ya as B,Z as A,e as $,l,m as h,o as L,ra as E,sa as H,ta as S,z as P,za as q}from"./chunk-KL6UIHOE.mjs";import"./chunk-X2SEQXRR.mjs";var v=W("[Weather Component] Set Last WeatherValues",V()),ce=W("[Weather Component] Reset Last WeatherValues");var J=W("[WeatherForcast Component] Set Last WeatherForcastValues",V()),le=W("[WeatherForcast Component] Reset Last WeatherForcastValues");function re(o,t){if(o&1&&(i(0,"div",11)(1,"p"),m(2),a(),y(3,"img",7),i(4,"p"),m(5),a()()),o&2){let e=t.$implicit,r=d(2);n(2),x((e==null?null:e.date)||"No date available"),n(),c("src",r.getWeatherIconUrl(e.icon?e.icon:"default-icon.png"),P),n(2),F("",r.convertToCelsius((e==null?null:e.temp)||0),"\xB0C")}}function ie(o,t){if(o&1){let e=w();i(0,"div",2)(1,"div",3)(2,"h1"),m(3),a(),i(4,"app-button",4),u("emitButtonClickEvent",function(){l(e);let s=d();return h(s.refreshWeatherForcast())}),a()(),i(5,"div",5)(6,"div",6),y(7,"img",7),a(),i(8,"div",8)(9,"p"),m(10),a(),i(11,"p"),m(12),a(),i(13,"p"),m(14),a(),i(15,"p"),m(16),a()()(),i(17,"div",9),g(18,re,6,3,"div",10),a()()}if(o&2){let e=d();n(3),x(e.weatherData?e.weatherData.city.name:"Unknown City"),n(),c("buttonName","\u27F3")("buttonType",e.ButtonTypeEnum.OutlineSecondary)("buttonSize","sm"),n(3),c("src",e.getWeatherIconUrl(e.weatherData?e.weatherData.list[0].weather[0].icon:"default-icon.png"),P),n(3),F("",e.convertToCelsius(e.weatherData?e.weatherData.list[0].main.temp:0),"\xB0C"),n(2),x(e.weatherData?e.weatherData.list[0].weather[0].description:"No description available"),n(2),z("Wind: ",e.weatherData?e.weatherData.list[0].wind.speed:0," m/s, ",e.weatherData?e.weatherData.list[0].wind.deg:0,"\xB0"),n(2),F("Pressure: ",e.weatherData?e.weatherData.list[0].main.pressure:0," hPa"),n(2),c("ngForOf",e.getDailyForecast())}}function ne(o,t){o&1&&(i(0,"div",12)(1,"h1"),m(2," Add City's / Countries and Select it "),a(),i(3,"h4"),m(4,"London, Vijayawada, Tirupati, Hyderabad....."),a()())}var C=class o{constructor(t,e){this.store=t;this.router=e}ButtonTypeEnum=T;weatherData;refreshWeatherForcastEmitter=new L;lastWeatherForcastValues$;ngOnInit(){this.router.events.subscribe(t=>{t instanceof O&&this.weatherData&&this.store.dispatch(J({weatherForcast:this.weatherData}))}),this.lastWeatherForcastValues$=this.store.select(t=>t.weatherForcast?.lastWeatherForcastValues),this.lastWeatherForcastValues$?.subscribe(t=>{t&&(this.weatherData=t)})}getWeatherIconUrl(t){return t?`https://openweathermap.org/img/wn/${t}.png`:""}getDailyForecast(){return this.weatherData?.list?this.weatherData.list.filter((e,r)=>r%8===0).map(e=>({date:new Date(e.dt*1e3).toLocaleDateString("en-US",{weekday:"short"}),temp:e.main.temp,icon:e.weather[0].icon})):[]}convertToCelsius(t){return(t-273.15).toFixed(2)}refreshWeatherForcast(){this.refreshWeatherForcastEmitter.emit()}static \u0275fac=function(e){return new(e||o)(f(I),f(D))};static \u0275cmp=b({type:o,selectors:[["app-weather-forcast"]],inputs:{weatherData:"weatherData"},outputs:{refreshWeatherForcastEmitter:"refreshWeatherForcastEmitter"},decls:2,vars:2,consts:[["class","weather-forecast",4,"ngIf"],["class","w-100 h-100",4,"ngIf"],[1,"weather-forecast"],[1,"row-display"],[3,"emitButtonClickEvent","buttonName","buttonType","buttonSize"],[1,"current-weather"],[1,"icon"],["alt","Weather Icon",3,"src"],[1,"details"],[1,"forecast"],["class","day",4,"ngFor","ngForOf"],[1,"day"],[1,"w-100","h-100"]],template:function(e,r){e&1&&g(0,ie,19,11,"div",0)(1,ne,5,0,"div",1),e&2&&(c("ngIf",r.weatherData),n(),c("ngIf",!r.weatherData))},dependencies:[S,E,H,M,B],styles:[".weather-forecast[_ngcontent-%COMP%]{font-family:Arial,sans-serif;color:#333;max-width:600px;margin:0 auto;padding:20px;border:1px solid #ddd;border-radius:10px;box-shadow:0 4px 8px #0000001a;flex-grow:1}.weather-forecast[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;text-align:center;margin-bottom:20px}.current-weather[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.current-weather[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px;height:250px}.current-weather[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.forecast[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:20px}.forecast[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{text-align:center}.forecast[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.row-display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}"]})};function ae(o,t){if(o&1){let e=w();i(0,"div",9)(1,"app-button",10),u("emitButtonClickEvent",function(){let s=l(e).$implicit,p=d();return h(p.getWeatherForcast(s))}),a(),i(2,"app-button",10),u("emitButtonClickEvent",function(){let s=l(e).$implicit,p=d();return h(p.getWeatherReport(s.name,!0))}),a(),i(3,"app-button",10),u("emitButtonClickEvent",function(){let s=l(e).$implicit,p=d();return h(p.removeWeatherReport(s.name))}),a()()}if(o&2){let e=t.$implicit,r=d();n(),c("buttonName",r.formatWeatherString(e))("buttonType",r.ButtonTypeEnum.Light)("buttonSize","sm"),n(),c("buttonName","\u27F3")("buttonType",r.ButtonTypeEnum.OutlineSecondary)("buttonSize","sm"),n(),c("buttonName","x")("buttonType",r.ButtonTypeEnum.OutlineDanger)("buttonSize","sm")}}var _=class o{constructor(t,e,r){this.weatherUpdateService=t;this.store=e;this.router=r}ButtonTypeEnum=T;citysWeatherReport=[];selectedWeatherCity;weatherData;lastWeatherValues$;lastselectedWeatherCity$;ngOnInit(){this.router.events.subscribe(t=>{t instanceof O&&this.store.dispatch(v({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity}))}),this.lastWeatherValues$=this.store.select(t=>({cities:t.weather?.lastWeatherValues,selectedCity:t.weather?.lastSelectedWeather})),this.lastWeatherValues$?.subscribe(t=>{this.citysWeatherReport=[...t?.cities||[]],this.selectedWeatherCity=t?.selectedCity?t.selectedCity:null})}getWeatherReport(t,e=!1){this.citysWeatherReport.findIndex(r=>r.name===t)>-1&&(e=!0),this.weatherUpdateService.getWeatherByCity(t).subscribe(r=>{if(e){let s=this.citysWeatherReport.findIndex(p=>p.name===t);s>-1&&(this.citysWeatherReport[s]=r)}else this.citysWeatherReport.unshift(r),this.citysWeatherReport.length>8&&this.citysWeatherReport.pop(),this.store.dispatch(v({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity}))},r=>{console.error("Error fetching weather:",r),alert("Error fetching weather: City/ Country not found")})}getWeatherForcast(t){this.selectedWeatherCity=t,this.weatherUpdateService.getWeatherReportForcast(t).subscribe(e=>{this.weatherData=e,this.store.dispatch(v({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity}))},e=>{console.error("Error fetching forcast:",e),alert("Error fetching forcast:"+e)})}convertToCelsius(t){return(t-273.15).toFixed(2)}formatWeatherString(t){let e=t.name,r=this.convertToCelsius(t.main.temp),s=t.weather[0].main;return`${e} - ${r}\xB0C ${s}`}removeWeatherReport(t){let e=this.citysWeatherReport.findIndex(r=>r.name===t);e>-1?(this.weatherData=null,this.citysWeatherReport.splice(e,1),console.log(`${t} weather report removed successfully.`)):console.warn(`${t} weather report not found.`)}removeCityReports(){this.citysWeatherReport.length<=0?alert("No data to remove"):(this.citysWeatherReport=[],this.weatherData=null,this.store.dispatch(v({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity})),alert("Weather Reports cleard"))}refreashWeatherForcast(){this.getWeatherForcast(this.selectedWeatherCity)}static \u0275fac=function(e){return new(e||o)(f(R),f(I),f(D))};static \u0275cmp=b({type:o,selectors:[["app-weather"]],features:[A([R])],decls:11,vars:6,consts:[["input",""],[1,"container","m-2"],[1,"recent-locations"],[1,"input-group","mb-3"],["type","text","placeholder","Type city name","aria-label","City name","aria-describedby","button-addon2",1,"form-control"],["id","button-addon2",3,"emitButtonClickEvent","buttonName","buttonType"],["class","location-item",4,"ngFor","ngForOf"],[3,"emitButtonClickEvent","buttonName","buttonType"],[1,"w-100","h-100",3,"refreshWeatherForcastEmitter","weatherData"],[1,"location-item"],[3,"emitButtonClickEvent","buttonName","buttonType","buttonSize"]],template:function(e,r){if(e&1){let s=w();i(0,"div",1)(1,"div",2)(2,"div",3),y(3,"input",4,0),i(5,"app-button",5),u("emitButtonClickEvent",function(){l(s);let k=j(4);return r.getWeatherReport(k.value),h(k.value="")}),a()(),i(6,"div"),g(7,ae,4,9,"div",6),a(),i(8,"app-button",7),u("emitButtonClickEvent",function(){return l(s),h(r.removeCityReports())}),a()(),i(9,"div")(10,"app-weather-forcast",8),u("refreshWeatherForcastEmitter",function(){return l(s),h(r.refreashWeatherForcast())}),a()()()}e&2&&(n(5),c("buttonName","+")("buttonType",r.ButtonTypeEnum.OutlineSecondary),n(2),c("ngForOf",r.citysWeatherReport),n(),c("buttonName","Clear All")("buttonType",r.ButtonTypeEnum.Danger),n(2),c("weatherData",r.weatherData))},dependencies:[C,M,B,E],styles:[".container[_ngcontent-%COMP%]{display:flex;min-height:fit-content;max-height:100%}.recent-locations[_ngcontent-%COMP%]{border-right:1px solid #ccc;padding-right:20px;margin-right:20px;max-width:fit-content;min-width:fit-content}.location-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.location-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:5px}.clear-button[_ngcontent-%COMP%]{margin-top:auto}@media (max-width: 768px){.container[_ngcontent-%COMP%]{flex-direction:column}.recent-locations[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #ccc;padding-bottom:20px;margin-bottom:20px;padding-right:0;margin-right:0;max-width:fit-content}}"]})};var oe=[{path:"",component:_}],Q=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=U({type:o});static \u0275inj=$({imports:[C,S,q,G,_,N.forChild(oe),N]})};export{Q as WeatherModule};
