import{A as x,B as j,C as z,F,G as L,H as E,I as A,M as S,O,R as P,S as H,T as D,V as T,Z as M,ca as R,da as I,e as N,ea as w,g as l,ga as q,h,i as k,j as B,k as n,l as f,m as _,n as $,o as y,p as c,r as i,s as a,t as C,u as W,v as u,w as d,x as U,y as m,z as b}from"./chunk-7LOKYOJQ.js";function tt(o,e){if(o&1&&(i(0,"div",11)(1,"p"),m(2),a(),C(3,"img",7),i(4,"p"),m(5),a()()),o&2){let t=e.$implicit,r=d(2);n(2),b((t==null?null:t.date)||"No date available"),n(),c("src",r.getWeatherIconUrl(t.icon?t.icon:"default-icon.png"),B),n(2),x("",r.convertToCelsius((t==null?null:t.temp)||0),"\xB0C")}}function et(o,e){if(o&1){let t=W();i(0,"div",2)(1,"div",3)(2,"h1"),m(3),a(),i(4,"app-button",4),u("emitButtonClickEvent",function(){l(t);let s=d();return h(s.refreshWeatherForcast())}),a()(),i(5,"div",5)(6,"div",6),C(7,"img",7),a(),i(8,"div",8)(9,"p"),m(10),a(),i(11,"p"),m(12),a(),i(13,"p"),m(14),a(),i(15,"p"),m(16),a()()(),i(17,"div",9),y(18,tt,6,3,"div",10),a()()}if(o&2){let t=d();n(3),b(t.weatherData?t.weatherData.city.name:"Unknown City"),n(),c("buttonName","\u27F3")("buttonType",t.ButtonTypeEnum.OutlineSecondary)("buttonSize","sm"),n(3),c("src",t.getWeatherIconUrl(t.weatherData?t.weatherData.list[0].weather[0].icon:"default-icon.png"),B),n(3),x("",t.convertToCelsius(t.weatherData?t.weatherData.list[0].main.temp:0),"\xB0C"),n(2),b(t.weatherData?t.weatherData.list[0].weather[0].description:"No description available"),n(2),j("Wind: ",t.weatherData?t.weatherData.list[0].wind.speed:0," m/s, ",t.weatherData?t.weatherData.list[0].wind.deg:0,"\xB0"),n(2),x("Pressure: ",t.weatherData?t.weatherData.list[0].main.pressure:0," hPa"),n(2),c("ngForOf",t.getDailyForecast())}}function rt(o,e){o&1&&(i(0,"div",12)(1,"h1"),m(2," Add City's / Countries and Select it "),a(),i(3,"h4"),m(4,"London, Vijayawada, Tirupati, Hyderabad....."),a()())}var g=class o{constructor(e,t){this.store=e;this.router=t}ButtonTypeEnum=T;weatherData;refreshWeatherForcastEmitter=new k;lastWeatherForcastValues$;ngOnInit(){this.router.events.subscribe(e=>{e instanceof S&&this.weatherData&&this.store.dispatch(q({weatherForcast:this.weatherData}))}),this.lastWeatherForcastValues$=this.store.select(e=>e.weatherForcast?.lastWeatherForcastValues),this.lastWeatherForcastValues$?.subscribe(e=>{e&&(this.weatherData=e)})}getWeatherIconUrl(e){return e?`https://openweathermap.org/img/wn/${e}.png`:""}getDailyForecast(){return this.weatherData?.list?this.weatherData.list.filter((t,r)=>r%8===0).map(t=>({date:new Date(t.dt*1e3).toLocaleDateString("en-US",{weekday:"short"}),temp:t.main.temp,icon:t.weather[0].icon})):[]}convertToCelsius(e){return(e-273.15).toFixed(2)}refreshWeatherForcast(){this.refreshWeatherForcastEmitter.emit()}static \u0275fac=function(t){return new(t||o)(f(M),f(O))};static \u0275cmp=_({type:o,selectors:[["app-weather-forcast"]],inputs:{weatherData:"weatherData"},outputs:{refreshWeatherForcastEmitter:"refreshWeatherForcastEmitter"},decls:2,vars:2,consts:[["class","weather-forecast",4,"ngIf"],["class","w-100 h-100",4,"ngIf"],[1,"weather-forecast"],[1,"row-display"],[3,"emitButtonClickEvent","buttonName","buttonType","buttonSize"],[1,"current-weather"],[1,"icon"],["alt","Weather Icon",3,"src"],[1,"details"],[1,"forecast"],["class","day",4,"ngFor","ngForOf"],[1,"day"],[1,"w-100","h-100"]],template:function(t,r){t&1&&y(0,et,19,11,"div",0)(1,rt,5,0,"div",1),t&2&&(c("ngIf",r.weatherData),n(),c("ngIf",!r.weatherData))},dependencies:[E,F,L,D,R],styles:[".weather-forecast[_ngcontent-%COMP%]{font-family:Arial,sans-serif;color:#333;max-width:600px;margin:0 auto;padding:20px;border:1px solid #ddd;border-radius:10px;box-shadow:0 4px 8px #0000001a;flex-grow:1}.weather-forecast[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;text-align:center;margin-bottom:20px}.current-weather[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.current-weather[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px;height:250px}.current-weather[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.forecast[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:20px}.forecast[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{text-align:center}.forecast[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.row-display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}"]})};function it(o,e){if(o&1){let t=W();i(0,"div",9)(1,"app-button",10),u("emitButtonClickEvent",function(){let s=l(t).$implicit,p=d();return h(p.getWeatherForcast(s))}),a(),i(2,"app-button",10),u("emitButtonClickEvent",function(){let s=l(t).$implicit,p=d();return h(p.getWeatherReport(s.name,!0))}),a(),i(3,"app-button",10),u("emitButtonClickEvent",function(){let s=l(t).$implicit,p=d();return h(p.removeWeatherReport(s.name))}),a()()}if(o&2){let t=e.$implicit,r=d();n(),c("buttonName",r.formatWeatherString(t))("buttonType",r.ButtonTypeEnum.Light)("buttonSize","sm"),n(),c("buttonName","\u27F3")("buttonType",r.ButtonTypeEnum.OutlineSecondary)("buttonSize","sm"),n(),c("buttonName","x")("buttonType",r.ButtonTypeEnum.OutlineDanger)("buttonSize","sm")}}var v=class o{constructor(e,t,r){this.weatherUpdateService=e;this.store=t;this.router=r}ButtonTypeEnum=T;citysWeatherReport=[];selectedWeatherCity;weatherData;lastWeatherValues$;lastselectedWeatherCity$;ngOnInit(){this.router.events.subscribe(e=>{e instanceof S&&this.store.dispatch(w({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity}))}),this.lastWeatherValues$=this.store.select(e=>({cities:e.weather?.lastWeatherValues,selectedCity:e.weather?.lastSelectedWeather})),this.lastWeatherValues$?.subscribe(e=>{this.citysWeatherReport=[...e?.cities||[]],this.selectedWeatherCity=e?.selectedCity?e.selectedCity:null})}getWeatherReport(e,t=!1){this.citysWeatherReport.findIndex(r=>r.name===e)>-1&&(t=!0),this.weatherUpdateService.getWeatherByCity(e).subscribe(r=>{if(t){let s=this.citysWeatherReport.findIndex(p=>p.name===e);s>-1&&(this.citysWeatherReport[s]=r)}else this.citysWeatherReport.unshift(r),this.citysWeatherReport.length>8&&this.citysWeatherReport.pop(),this.store.dispatch(w({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity}))},r=>{console.error("Error fetching weather:",r),alert("Error fetching weather: City/ Country not found")})}getWeatherForcast(e){this.selectedWeatherCity=e,this.weatherUpdateService.getWeatherReportForcast(e).subscribe(t=>{this.weatherData=t,this.store.dispatch(w({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity}))},t=>{console.error("Error fetching forcast:",t),alert("Error fetching forcast:"+t)})}convertToCelsius(e){return(e-273.15).toFixed(2)}formatWeatherString(e){let t=e.name,r=this.convertToCelsius(e.main.temp),s=e.weather[0].main;return`${t} - ${r}\xB0C ${s}`}removeWeatherReport(e){let t=this.citysWeatherReport.findIndex(r=>r.name===e);t>-1?(this.weatherData=null,this.citysWeatherReport.splice(t,1),console.log(`${e} weather report removed successfully.`)):console.warn(`${e} weather report not found.`)}removeCityReports(){this.citysWeatherReport.length<=0?alert("No data to remove"):(this.citysWeatherReport=[],this.weatherData=null,this.store.dispatch(w({weather:this.citysWeatherReport,selectedWeather:this.selectedWeatherCity})),alert("Weather Reports cleard"))}refreashWeatherForcast(){this.getWeatherForcast(this.selectedWeatherCity)}static \u0275fac=function(t){return new(t||o)(f(I),f(M),f(O))};static \u0275cmp=_({type:o,selectors:[["app-weather"]],features:[z([I])],decls:11,vars:6,consts:[["input",""],[1,"container","m-2"],[1,"recent-locations"],[1,"input-group","mb-3"],["type","text","placeholder","Type city name","aria-label","City name","aria-describedby","button-addon2",1,"form-control"],["id","button-addon2",3,"emitButtonClickEvent","buttonName","buttonType"],["class","location-item",4,"ngFor","ngForOf"],[3,"emitButtonClickEvent","buttonName","buttonType"],[1,"w-100","h-100",3,"refreshWeatherForcastEmitter","weatherData"],[1,"location-item"],[3,"emitButtonClickEvent","buttonName","buttonType","buttonSize"]],template:function(t,r){if(t&1){let s=W();i(0,"div",1)(1,"div",2)(2,"div",3),C(3,"input",4,0),i(5,"app-button",5),u("emitButtonClickEvent",function(){l(s);let V=U(4);return r.getWeatherReport(V.value),h(V.value="")}),a()(),i(6,"div"),y(7,it,4,9,"div",6),a(),i(8,"app-button",7),u("emitButtonClickEvent",function(){return l(s),h(r.removeCityReports())}),a()(),i(9,"div")(10,"app-weather-forcast",8),u("refreshWeatherForcastEmitter",function(){return l(s),h(r.refreashWeatherForcast())}),a()()()}t&2&&(n(5),c("buttonName","+")("buttonType",r.ButtonTypeEnum.OutlineSecondary),n(2),c("ngForOf",r.citysWeatherReport),n(),c("buttonName","Clear All")("buttonType",r.ButtonTypeEnum.Danger),n(2),c("weatherData",r.weatherData))},dependencies:[g,D,R,F],styles:[".container[_ngcontent-%COMP%]{display:flex;min-height:fit-content;max-height:100%}.recent-locations[_ngcontent-%COMP%]{border-right:1px solid #ccc;padding-right:20px;margin-right:20px;max-width:fit-content;min-width:fit-content}.location-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.location-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:5px}.clear-button[_ngcontent-%COMP%]{margin-top:auto}@media (max-width: 768px){.container[_ngcontent-%COMP%]{flex-direction:column}.recent-locations[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #ccc;padding-bottom:20px;margin-bottom:20px;padding-right:0;margin-right:0;max-width:fit-content}}"]})};var nt=[{path:"",component:v}],J=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=$({type:o});static \u0275inj=N({imports:[g,E,A,H,v,P.forChild(nt),P]})};export{J as WeatherModule};
